<!DOCTYPE html>
<html lang='en-US'>>
    <head>
      <h1>Harvest Report</h1>
    </head>
    <body>
      <div id="vue">
        <p>This page is a <i>mockup</i> of a simplified harvest report.</p> 
            <label for=”title”>Title: </label>
              <input type="text" id="title" name="title" v-model="Title" />
            <br><br>
            <label for="start">Start:</label>
            <input type="date" id="start" name="start date" v-model="Sdate" 
            v-bind:disabled='Sdate > Edate' min="2014-01-01" max="2022-01-01">
            <label for="end">End:</label>
            <input type="date" id="end" name="end date" v-model="Edate"
            v-bind:disabled='Edate < Sdate' min="2020-05-05" max="2022-01-01">
            <br><br>
            <label for=”crop”>Crop: </label>
            <select id="crop" name="crop" v-model="crop">  
              <option v-for="crop in cropsName">{{ crop }}</option>       
            </select> 
            <label for=”field”>Area: </label>
            <select id="field" name="field" v-model="area">
                <option v-for="area in areasName">{{ area }}</option>
            </select>
            <br><br>
            <button type="button" @click='Newlog'>Generate Report</button>
            <br><br>
    </body>
    <hr>
      <h2 v-if="harvestLog.length === 0">No result matches</h2>
      <h2 v-else>{{ Title ? Title : 'Mock Harvest Report'}}</h2>
    <p>Details:</p>
    <body>   
        <ul>
            <li><strong>Farm</strong>:{{ farm }}</li>
            <li><strong>User</strong>:{{ user }}</li>
            <li><strong>Language</strong>:{{ language }}</li><br>
            <li><strong>Start</strong>:{{ Sdate }}</li>
            <li><strong>End</strong>:{{ Edate }}</li>
            <li><strong>Crop</strong>:{{ crop }}</li>
        </ul>
        <br><br>
        <table border="1">
          <tr>
            <td><strong>Row</strong></td>
            <td><strong>Date</strong></td>
            <td><strong>Area</strong></td>
            <td><strong>Crop</strong></td>
            <td><strong>Yield</strong></td>
            <td><strong>Units</strong></td>
          </tr>
          <tr v-for="(l,index) in harvestLog">
            <td>{{ index+1 }}</td>
            <td>{{ l.date }}</td>
            <td>{{ l.area }}</td>
            <td>{{ l.crop }}</td>
            <td>{{ l.yield }}</td>
            <td>{{ l.units }}</td>
          </tr>
        </table> 
      </div>
        <script>
          var Vue1 = new Vue({
            el: "#vue",
            created() {
              getIDToCropMap()
              .then((theMap) => {
                this.idToCropMap = theMap;
              })
              .catch((err) => {
                console.log("getIDToCropMap caught an error.")
              })
              getIDToAreaMap()
              .then((theMap) => {
                this.idToAreaMap = theMap;
              })
              .catch((err) => {
                console.log("getIDToAreaMap caught an error.")
              })
            },
            data:{
              Title:"My Sample Harvest Report",
              Sdate:"2018-05-01",
              Edate:"2018-05-15",
              crop:'Kale',
              area:'All',
              log:'',
              state:'default',
              farm: '',
              user: '',
              language: '',
              farmInfo: '',
              idToCropMap: new Map(),
              idToAreaMap: new Map(),
              crops: [
                {text: "Broccoli", value: "Broccoli"},
                {text: "Kale", value: "Kale"},
                {text: "Peas", value: "Peas"},
              ],
              areas: [
                {text: "All", value: "All"},
                {text: "Chuau-1", value: "Chuau-1"},
                {text: "SQ7", value: "SQ7"},
              ],
              harvestLog: [
    
              ],
            },
            computed: {
              cropsName() {
                return Array.from(this.$data.idToCropMap.values());
              },
              areasName() {
                return Array.from(this.$data.idToAreaMap.values());
              }
            },
            methods: {
              Newlog: function() {
                axios.get('/farm.json')
                  .then((response) => {
                  this.farmName = response.data.name;
                  this.currentUser = response.data.user.name;
                  this.language = response.data.languages.en.name;
                })
                  .catch((error) => {
                  console.log("Error occurred.")
                  console.log(error)
                })
                  this.harvestLog.push({date:'05/08/2020',area:'Orion-3',crop:'Kale',yield:12,units:'Bunches'});
                },
            }
          });
          Vue.config.devtools = true;
        </script>
    </body>

</html>