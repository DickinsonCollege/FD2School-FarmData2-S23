<html>
<div id="vueinfo" v-cloak>
	<h1>Harvest Report</h1>
	<p>This page is a <i>mockup</i> of a simplified harvest report.</p>
	<label for=”reportTitle”>Title:</label>
	<input type="text" id="reportTitle" name="title" v-model="rptTitle" value="My Sample Harvest Report" 
	/><br><br>
	<label for=”start”>Start:</label>
	<input type="date" id="start" name="start" v-model="rptStart" value="2020-05-05" min="2014-01-01" :max="rptEnd">
	<label for=”end”>End:</label>
	<input type="date" id="end" name="end" v-model="rptEnd" value="2020-05-15" max="2022-01-01" :min="rptStart">
	<br><br>
	<label for=”crop”>Crop:</label>
	<select id="crop" name="Crop" v-model="rptCrop">
		<option v-for="crop in cropNames">{{crop}}</option>
	</select>
	<label for=”area”>Area:</label>
	<select id="area" name="Area">
		<option v-for="area in areas">{{area}}</option>
	</select>
	<br><br>
	<input type="button" value="Generate Report" @click="addLog" />
	<hr>
	<h1>{{rptTitle=='' ? 'Mock Harvest Report':rptTitle}}</h1>
	<p>Details:</p>
	<ul>
		<li><b>Farm:</b>{{farm}}</li>
		<li><b>User:</b>{{user}}</li>
		<li><b>Language:</b>{{language}}</li><br>
		<li><b>Start:</b>05/01/2018</li>
		<li><b>End:</b>05/15/2018</li>
		<li><b>Crop:</b>Kale</li>
	</ul>

	<p v-if="harvestLogs.length===0">No records match.</p>
	<table border=2 v-else>
		<tr>
			<th>Row</th>
			<th>Date</th>
			<th>Area</th>
			<th>Crop</th>
			<th>Yield</th>
			<th>Units</th>
		</tr>
		<tr v-for="(d,index) in harvestLogs">
			<td>{{index+1}}</td>
			<td>{{d.date}}</td>
			<td>{{d.area}}</td>
			<td>{{d.crop}}</td>
			<td>{{d.yield}}</td>
			<td>{{d.units}}</td>
		</tr>
	</table>
</div>
<script>
	var sample = new Vue({
		el: '#vueinfo',
		created() {
			getIDToCropMap().then((theMap) => {
				this.idToCropMap = theMap;
			})
				.catch((err) => {
					console.log("An error has occured.");
					console.log(err);
				})
		},
		data: {
			idToCropMap: new Map(),
			rptTitle: 'My Sample Harvest Report',
			rptStart: '02-20-2018',
			rptEnd: '01-25-2020',
			rptCrop: 'Broccoli',
			areas: ['All','Chuau-1','SQ7',],
			harvestLogs: [],
			farm: '',
			user: '',
			language: '',
		},
		computed: {
			cropNames() {
				return Array.from(this.idToCropMap.values());
			}
		},
		methods: {
			addLog: function () {
				axios.get('/farm.json')
					.then((response) => {
						this.farm = response.data.name;
						this.user = response.data.user.name;
						this.language = response.data.user.languages.en.name;
					})
					.catch((error) => {
						console.log("Error Occured")
						console.log(error)
					})
				this.harvestLogs.push({ row: this.index + 1, date: '2018-06-03', area: 'Orion-3', crop: 'Kale', yield: 12, units: 'Bunches' });
			}
		}
	});
	Vue.config.devtools = true;
</script>
</html>